/* jQuery Drilldown Selector / version: 1.0.1 / author: Sean Metzgar */
(function(e){e.drilldownSelector=function(s,t){var g,q,u,y,l,k,r,b,m,p,v,h,w,x,d,c;this.version="1.0.1";g=1;q=0;u=!1;y={containerClass:"drilldownSelectorContainer",loaderClass:"drilldownSelectorLoader",loaderText:"Loading...",menuClass:"drilldownSelectorMenu",navClass:"drilldownSelectorNav",navBackClass:"back",navBackText:"Back",navHomeClass:"home",navHomeText:"Home",hasSubsClass:"hasSubs",goBackClass:"goBack",checkboxClass:"checkbox"};l=e(s);v=p=m=b=r=k=null;h='{"sections": [';w=null;x="";d={};c=
{buildFramework:function(){k=e('<div class="'+d.containerClass+'"></div>').insertAfter(l);m=e('<div class="'+d.navClass+'"></div>').appendTo(k);p=e('<a href="#" class="'+d.navBackClass+'">'+d.navBackText+"</a>").appendTo(m);v=e('<a href="#" class="'+d.navHomeClass+'">'+d.navHomeText+"</a>").appendTo(m);r=e('<p class="'+d.loaderClass+'">'+d.loaderText+"</p>").appendTo(k);b=e('<div class="'+d.menuClass+'"></div>').appendTo(k)},buildJSON:function(){l.find("option").each(function(){var a=e(this).text(),
z=e(this).attr("value"),b=null,d=0,n=!1,b="",n=e(this).is(":selected")?!0:!1,f=!0;n&&(u?n=!1:u=!0);0<a.length&&(b=a.match(/^\-[\-]*\s/i),null!==b&&("object"===typeof b&&0<b.length&&"string"===typeof b[0])&&(d=b[0].replace(/\s/i,"").length,b=a.replace(b[0],""),(n=c.addSection(d,b,z,n))?(h+=n,g=d):(h+=c.endJSON(),f=!1)));return f});h+=c.endJSON();w=JSON.parse(h)},buildHTML:function(a){var b="",e=null,d=null;if(a.hasOwnProperty("sections")&&0<a.sections.length){b+="<ul>";for(e in a.sections)a.sections.hasOwnProperty(e)&&
(d=a.sections[e],b+="<li"+(!0===d.selected?' class="selected"':"")+'><a href="#" data-value="',b+=d.value+'">'+d.text+"</a>",d.sections&&0<d.sections.length&&(b+=c.buildHTML(d)),b+="</li>");b+="</ul>"}return b},buildMenu:function(){x=c.buildHTML(w);b.append(x)},addSection:function(a,b,c,e){var d=0,f="";if(0!==q)if(a===g)f+="},";else if(a>g&&a===g+1)f+=', "sections": [';else if(a<g){for(d=1;d<=g-a;d+=1)f+="}]";f+="},"}else f=!1;else f=a===g?f+"":!1;!1!==f&&(f+='{"text": "'+b+'", "value": "'+c+'", "selected": '+
(e?"true":"false"),q+=1);return f},endJSON:function(){for(var a=0,b="",a=1;a<=g;a+=1)b+="}]";return b+"}"},addClasses:function(){var a=b.find("li.selected");b.find("li").each(function(){0<e(this).find("ul").length&&e(this).addClass(d.hasSubsClass)});0===a.length?b.children("ul").addClass("active"):1===a.length?a.parent("ul").addClass("active"):(a.removeClass("selected"),b.children("ul").addClass("active"));c.fixHeight();c.checkBackButton()},addCheckboxes:function(){var a=null;b.find("li").each(function(){isNaN(e(this).children("a").attr("data-value"))||
e(this).children("a").append('<span class="checkbox">&nbsp;</span>')});a=b.find(".selected .checkbox").eq(0);1===a.length&&c.selectCheckbox(a)},addListeners:function(){b.find("a").click(function(a){var b=null;a.preventDefault();b=e(this).parent("li");c.goForward(b)});b.find(".checkbox").click(function(a){a.preventDefault();a.stopPropagation();e(this).parents("li").eq(0).hasClass("selected")?c.deselectCheckbox():c.selectCheckbox(e(this))});p.click(function(a){a.preventDefault();c.goBack(!1)});v.click(function(a){a.preventDefault();
c.goBack(!0)})},deselectCheckbox:function(){l.find("option").prop("selected",!1);b.find("li").removeClass("selected")},selectCheckbox:function(a){var b=a.parent("a");a=a.parent("a").parent("li");b=b.attr("data-value");c.deselectCheckbox();a.addClass("selected");l.find("option[value="+b+"]").prop("selected",!0)},goBack:function(a){a="boolean"===typeof a?a:!1;c.deselectCheckbox();a?(b.find(".active").removeClass("active"),b.children("ul").addClass("active")):b.find(".active").removeClass("active").parents("ul:eq(0)").addClass("active");
c.fixHeight();c.checkBackButton()},goForward:function(a){a.hasClass(d.hasSubsClass)&&(c.deselectCheckbox(),b.find(".active").removeClass("active"),a.children("ul").addClass("active"),c.fixHeight(),c.checkBackButton())},checkBackButton:function(){b.children("ul").hasClass("active")?p.hide():p.show()},showLoader:function(){k.show();m.hide();b.hide();r.show()},showSelector:function(){k.show();r.hide();m.show();b.show()},fixHeight:function(){b.height(b.find(".active").height())}};this.init=function(){d=
e.extend({},y,t);c.buildFramework();c.showLoader();window.setTimeout?window.setTimeout(function(){c.buildJSON();c.buildMenu();c.addClasses();c.addCheckboxes();c.addListeners();c.checkBackButton();c.showSelector();c.fixHeight()},1E3):(c.buildJSON(),c.buildMenu(),c.addClasses(),c.addCheckboxes(),c.addListeners(),c.checkBackButton(),c.showSelector(),c.fixHeight())};this.getValue=function(){var a=!1,a=l.val();switch(typeof a){case "string":break;case "object":a=0<a.length?a[0]:!1;break;default:a=!1}return a};
this.init()};e.fn.drilldownSelector=function(s){return this.each(function(){if(void 0===e(this).data("drilldownSelector")){var t=new e.drilldownSelector(this,s);e(this).data("drilldownSelector",t)}})}})(jQuery);